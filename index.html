<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>지사 마케팅용 링크 및 계정정보</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <style>
    /* [기본 설정: 가독성 중심] */
    html { font-size: 17px; } 
    @media (max-width: 640px) { html { font-size: 16px; } }

    body { font-family: 'Noto Sans KR', sans-serif; background-color: #f1f5f9; color: #1e293b; word-break: keep-all; }
    
    /* 스크롤바 */
    ::-webkit-scrollbar { width: 10px; height: 10px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 5px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }

    /* 카드 스타일 (그림자 강조) */
    .info-card { 
        background: white; 
        border-radius: 16px; 
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border: 1px solid #e2e8f0; /* 기본 테두리 */
        border-left-width: 8px; /* 왼쪽 포인트 선 두께 통일 */
        overflow: hidden;
        margin-bottom: 24px;
    }

    /* 아코디언 애니메이션 */
    .accordion-content {
      transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
      max-height: 0; opacity: 0; overflow: hidden;
    }
    .accordion-content.open { max-height: 3000px; opacity: 1; }
    .accordion-icon { transition: transform 0.3s ease; }
    .accordion-icon.rotate { transform: rotate(180deg); }

    /* 탭 디자인 */
    .tab-btn { position: relative; font-size: 1.1rem; }
    .tab-btn::after {
        content: ''; position: absolute; bottom: 0; left: 0; width: 0%; height: 4px;
        background-color: #0f172a; transition: width 0.3s;
    }
    .tab-btn.active::after { width: 100%; }
    .tab-btn.active { color: #0f172a; font-weight: 800; }

/* 테이블 스타일 개선 */
    .custom-table th { background-color: #f1f5f9; color: #475569; font-weight: 800; }
    .custom-table tr:nth-child(even) { background-color: #f8fafc; } /* 짝수행: 아주 연한 회색 */

    .custom-table tbody tr:hover { 
        background-color: #e2e8f0 !important; 
        cursor: default; 
    }
    
    /* 버튼 스타일 */
    .btn-action {
        display: flex; align-items: center; justify-content: center;
        padding: 12px 16px; border-radius: 12px; font-weight: 700; transition: all 0.2s;
        border: 1px solid #cbd5e1; background-color: white; color: #334155;
        box-shadow: 0 2px 0 #cbd5e1; 
    }
    .btn-action:hover { transform: translateY(-2px); box-shadow: 0 4px 0 #94a3b8; background-color: #f8fafc; }
    .btn-action:active { transform: translateY(0); box-shadow: none; }
    
    .btn-primary {
        background-color: #1e293b; color: white; border: 1px solid #0f172a; box-shadow: 0 2px 0 #0f172a;
    }
    .btn-primary:hover { background-color: #334155; color: white; box-shadow: 0 4px 0 #0f172a; }

/* 기존 CSS 부분에 덮어쓰거나 수정 */
@media (max-width: 640px) {
    /* 메인 타이틀 크기만 별도 지정 */
    #user-title-container h1 { 
        font-size: 1.5rem !important; /* 모바일에서 님, 응원합니다 글자 크기 */
        line-height: 1.4;
    }
}

.custom-table th, .custom-table td {
    white-space: nowrap; /* [추가] 표 안의 글자가 아래로 떨어지지 않게 설정 */
    word-break: keep-all;
}

  </style>
</head>
<body class="antialiased selection:bg-slate-300 selection:text-slate-900">

  <div id="login-container" class="min-h-screen flex items-center justify-center p-4 bg-slate-100 relative overflow-hidden">

<div class="bg-white p-8 sm:p-12 rounded-2xl shadow-2xl w-full max-w-md border border-slate-200 relative z-10">
      
      <div class="text-center mb-8">
        <h2 class="text-3xl font-black text-slate-800 mb-2">PARTNER LOGIN</h2>
        <p class="text-slate-500 font-medium mb-4">지사 파트너 전용 대시보드</p>
        
        <div class="bg-blue-50 border border-blue-100 rounded-xl p-4 text-center">
            <p class="text-xs text-slate-600 leading-relaxed">
                <strong class="text-blue-700 block mb-1.5"><i class="fas fa-info-circle mr-1"></i> 디자인 업데이트 안내</strong>
                가독성과 편의성을 위해 디자인이 새롭게 개편되었습니다.<br>
                전달받으신 <strong>기존 아이디(성명)</strong>와 <strong>비밀번호</strong> 그대로<br>
                로그인해주시면 됩니다.
            </p>
        </div>
      </div>

      <div class="space-y-5">
        <div>
            <label class="block text-sm font-bold text-slate-600 mb-2">아이디 (성명)</label>
            <input type="text" id="username" placeholder="성명을 입력해주세요" class="w-full px-4 py-4 rounded-xl bg-slate-50 border border-slate-300 focus:bg-white focus:border-slate-800 focus:ring-1 focus:ring-slate-800 transition-all outline-none font-medium text-lg placeholder:text-slate-400 placeholder:text-base" required onkeypress="if(event.key==='Enter') document.getElementById('password').focus()">
        </div>
        <div>
            <label class="block text-sm font-bold text-slate-600 mb-2">비밀번호</label>
            <input type="password" id="password" placeholder="비밀번호를 입력해주세요" class="w-full px-4 py-4 rounded-xl bg-slate-50 border border-slate-300 focus:bg-white focus:border-slate-800 focus:ring-1 focus:ring-slate-800 transition-all outline-none font-medium text-lg placeholder:text-slate-400 placeholder:text-base" required onkeypress="if(event.key==='Enter') handleLogin()">
        </div>
        <button onclick="handleLogin()" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-4 rounded-xl transition-all shadow-lg text-lg mt-4">
            로그인 하기
        </button>
      </div>

      <div id="loading" class="hidden mt-6 text-center text-slate-600 font-medium animate-pulse">
        <i class="fas fa-circle-notch fa-spin mr-2"></i> 데이터를 불러오고 있습니다...
      </div>
      <p id="error-message" class="mt-4 text-center text-red-600 font-bold min-h-[24px]"></p>
    </div>
  </div>

  <!-- 비밀번호 변경 모달 -->
  <div id="password-change-modal" class="hidden min-h-screen flex items-center justify-center p-4 bg-slate-100">
    <div class="bg-white p-8 sm:p-12 rounded-2xl shadow-2xl w-full max-w-md border border-slate-200">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-black text-slate-800 mb-2"><i class="fas fa-key text-amber-500 mr-2"></i>비밀번호 변경</h2>
        <p class="text-slate-500 font-medium">보안을 위해 비밀번호를 변경해주세요.</p>
      </div>
      <div class="space-y-5">
        <div>
          <label class="block text-sm font-bold text-slate-600 mb-2">새 비밀번호</label>
          <input type="password" id="new-password" placeholder="새 비밀번호 입력" class="w-full px-4 py-4 rounded-xl bg-slate-50 border border-slate-300 focus:bg-white focus:border-slate-800 focus:ring-1 focus:ring-slate-800 transition-all outline-none font-medium text-lg">
        </div>
        <div>
          <label class="block text-sm font-bold text-slate-600 mb-2">새 비밀번호 확인</label>
          <input type="password" id="new-password-confirm" placeholder="새 비밀번호 다시 입력" class="w-full px-4 py-4 rounded-xl bg-slate-50 border border-slate-300 focus:bg-white focus:border-slate-800 focus:ring-1 focus:ring-slate-800 transition-all outline-none font-medium text-lg" onkeypress="if(event.key==='Enter') handlePasswordChange()">
        </div>
        <button onclick="handlePasswordChange()" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-4 rounded-xl transition-all shadow-lg text-lg mt-4">
          비밀번호 변경하기
        </button>
      </div>
      <div id="pw-change-loading" class="hidden mt-6 text-center text-slate-600 font-medium animate-pulse">
        <i class="fas fa-circle-notch fa-spin mr-2"></i> 처리 중...
      </div>
      <p id="pw-change-error" class="mt-4 text-center text-red-600 font-bold min-h-[24px]"></p>
    </div>
  </div>

<div id="main-content" class="max-w-4xl mx-auto px-4 py-10 hidden min-h-screen pb-12 sm:pb-32">
    
<header class="mb-8" id="user-title-container">
  <div class="flex justify-between items-start">
    <div>
      <h1 class="text-3xl font-black text-slate-900 leading-tight">
        <span id="user-title" class="text-blue-900"></span>님,<br>
        <span>성공적인 영업을 응원합니다.</span>
      </h1>
      <p class="text-slate-500 mt-2 font-medium border-l-4 border-slate-400 pl-3">
        (주)한국FP센터 지사 파트너 공식 페이지
      </p>
    </div>
    <button onclick="handleLogout()" class="flex items-center gap-2 px-4 py-2 text-sm font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors">
      <i class="fas fa-sign-out-alt"></i>
      <span class="hidden sm:inline">로그아웃</span>
    </button>
  </div>
</header>

    <nav class="flex border-b-2 border-slate-200 mb-8">
      <button id="tab-btn-account" class="tab-btn flex-1 py-4 text-slate-400 hover:text-slate-600 transition-colors active" onclick="showTab('account-info')">
        <i class="fas fa-list-ul mr-2"></i>운영 정보 & 링크
      </button>
      <button id="tab-btn-commission" class="tab-btn flex-1 py-4 text-slate-400 hover:text-slate-600 transition-colors" onclick="showTab('commission-statement')">
        <i class="fas fa-coins mr-2"></i>수수료 명세서
      </button>
    </nav>
    
    <div id="account-info" class="tab-content animate-fade-in">
        
        <div class="info-card border-l-gray-400"> <div class="bg-slate-100 p-5 flex justify-between items-center cursor-pointer hover:bg-slate-200 transition-colors" onclick="toggleAccordion('notice-body')">
              <span class="font-bold text-lg text-slate-800 flex items-center gap-3"><i class="fas fa-bullhorn text-red-500"></i> 본사 공지사항 확인</span>
              <i id="notice-body-icon" class="fas fa-chevron-down accordion-icon text-slate-500 text-xl"></i>
            </div>
            <div id="notice-body" class="accordion-content hidden">
              <div class="p-6 border-t border-slate-200">
                <h3 id="notice-title" class="text-xl font-bold text-slate-900 mb-4 pb-2 border-b border-slate-200"></h3>
                <div id="notice-content" class="text-slate-700 leading-relaxed text-base"></div>
              </div>
            </div>
        </div>

        <section class="info-card border-l-emerald-600"> <div class="p-6 md:p-8">
                <h2 class="text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2 flex items-center">
                    <i class="fas fa-users text-emerald-700 mr-2"></i> (주)한국FP센터 파트너스
                </h2>
                
<div class="bg-slate-50 rounded-xl p-6 border border-slate-200 mb-6">
    <div class="flex flex-row gap-4"> <div class="flex-1 border-r border-slate-200"> <span class="text-xs font-bold text-slate-500 block mb-1">파트너 ID</span>
            <span class="text-slate-900 font-black text-lg sm:text-2xl" id="fp-id"></span>
        </div>
        <div class="flex-1 pl-2">
             <span class="text-xs font-bold text-slate-500 block mb-1">비밀번호</span>
             <span class="text-slate-900 font-black text-lg sm:text-2xl" id="fp-pw"></span>
        </div>
    </div>
</div>

                <div class="space-y-4 text-base">
<div class="bg-slate-50 p-5 rounded-xl border border-slate-200 mb-4 flex flex-col sm:flex-row justify-between items-center shadow-sm gap-3">
    <span class="text-slate-700 font-bold text-lg text-center sm:text-left">
        <i class="fas fa-hand-holding-dollar text-emerald-600 mr-2"></i>이너서클 모집 수수료
    </span>
    <span class="text-emerald-600 font-black text-4xl sm:text-2xl">30%</span>
</div>
                    <div class="flex flex-col gap-2 border-b border-slate-100 pb-3">
                        <span class="text-slate-600 font-bold">회원가입 URL</span>
                        <a id="fp-url" href="" target="_blank" class="text-blue-600 hover:underline truncate font-medium bg-blue-50 p-2 rounded block"></a>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-xl flex flex-col sm:flex-row justify-between items-center gap-3">
                        <div>
                            <span class="text-slate-700 font-bold block"><i class="fas fa-cog mr-1"></i> 관리자 페이지</span>
                            <span class="text-xs text-slate-500 font-bold ml-6">※ 아이디/비번은 위와 동일합니다.</span>
                        </div>
                        <a href="https://kfpcenter.co.kr/adm_Manage/account/login.php" target="_blank" class="btn-action py-2 px-4 text-sm w-full sm:w-auto">
                            관리자 로그인 <i class="fas fa-external-link-alt ml-2"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="info-card border-l-blue-800"> <div class="p-6 md:p-8">
                <h2 class="text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2 flex items-center">
                    <i class="fas fa-building text-blue-800 mr-2"></i> 기업 홈페이지 (통합 리뉴얼)
                </h2>

<div class="bg-slate-50 p-5 rounded-xl border border-slate-200 mb-6 flex flex-col sm:flex-row justify-between items-center shadow-sm gap-3">
    <span class="text-slate-700 font-bold text-lg text-center sm:text-left">
        <i class="fas fa-hand-holding-dollar text-blue-600 mr-2"></i>기업 홈페이지 모집 수수료
    </span>
    <span class="text-blue-700 font-black text-4xl sm:text-2xl">30%</span>
</div>

                <div class="bg-slate-50 rounded-xl p-6 border border-slate-200 mb-8 text-center shadow-inner">
                    <div class="inline-block bg-red-600 text-white text-sm font-bold px-3 py-1 rounded-full mb-4 animate-bounce">
                        선착순 100개 기업 파격 혜택
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                            <p class="text-sm text-slate-500 font-bold mb-1">초기 세팅비 (정가 100만원)</p>
                            <p class="text-red-600 font-black text-2xl">0원 <span class="text-sm text-slate-500 font-normal">(100% 면제)</span></p>
                        </div>
                        <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                            <p class="text-sm text-slate-500 font-bold mb-1">웹호스팅비</p>
                            <p class="text-slate-800 font-black text-2xl">무료 <span class="text-sm text-slate-500 font-normal">(전기간)</span></p>
                        </div>
                        <div class="bg-slate-800 text-white p-4 rounded-xl shadow-md">
                            <p class="text-sm text-slate-300 font-bold mb-1">월 이용료</p>
                            <p class="font-black text-2xl text-yellow-400">10만원</p>
                        </div>
                    </div>
                </div>

                <h3 class="font-bold text-slate-700 mb-3 text-lg"><i class="fas fa-download mr-2"></i>제안서 및 자료 다운로드</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <a href="https://drive.google.com/file/d/1pBSuuEKX2dqCtGJB0IqR33QoCbQEhJGJ/view?usp=drive_link" target="_blank" class="btn-action">
                        <i class="fas fa-book-open text-blue-600 text-xl mr-3"></i> 
                        <span class="text-left leading-tight">관리자 페이지 매뉴얼<br><span class="text-xs text-slate-500">PDF (E-Book)</span></span>
                    </a>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSe0Y5Covznb3QUnPSsy71U-STI-0A3bimm7c_6ZlrMMpENMBA/viewform?usp=header" target="_blank" class="btn-action">
                        <i class="fas fa-file-signature text-green-600 text-xl mr-3"></i> 
                        <span class="text-left leading-tight">홈페이지 제작 신청서<br><span class="text-xs text-slate-500">구글폼 작성</span></span>
                    </a>
                    <a href="https://pt-corp-homepage.netlify.app/" target="_blank" class="btn-action">
                        <i class="fas fa-laptop-file text-purple-600 text-xl mr-3"></i> 
                        <span class="text-left leading-tight">기업 홈페이지 제안서<br><span class="text-xs text-slate-500">웹 링크 확인</span></span>
                    </a>
                    <a href="https://drive.google.com/file/d/1AMVRVrJn_LeEbtM3b7HKGSDHUqcGQjXe/view?usp=drive_link" target="_blank" class="btn-action">
                        <i class="fas fa-print text-orange-600 text-xl mr-3"></i> 
                        <span class="text-left leading-tight">기업 홈페이지 안내문<br><span class="text-xs text-slate-500">A4 출력용 (JPG)</span></span>
                    </a>
                </div>

                <!-- 영업자 전용 링크 (고객 전달용) -->
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-100 mb-6">
                    <label class="block font-bold text-blue-900 mb-4 flex items-center">
                        <i class="fas fa-link mr-2"></i>영업자 전용 링크
                        <span class="text-xs text-blue-600 ml-2 font-bold opacity-80">(고객 전달용)</span>
                    </label>

                    <!-- 홈페이지 문의 링크 -->
                    <div class="mb-3">
                        <span class="text-sm font-bold text-slate-600 mb-1 block">홈페이지 문의</span>
                        <div class="flex flex-col sm:flex-row gap-2">
                            <a id="corp-inquiry-display" href="javascript:void(0)" target="_blank" class="flex-1 bg-white px-4 py-3 rounded-lg border border-blue-200 font-medium text-slate-600 truncate shadow-sm hover:text-blue-600 hover:bg-blue-50 transition-colors text-sm">
                                링크 불러오는 중...
                            </a>
                            <button onclick="copyCorpInquiry()" class="btn-primary px-5 py-3 rounded-lg sm:w-auto w-full whitespace-nowrap text-sm">
                                복사
                            </button>
                        </div>
                    </div>

                    <!-- 홈페이지 제작 링크 -->
                    <div>
                        <span class="text-sm font-bold text-slate-600 mb-1 block">홈페이지 제작</span>
                        <div class="flex flex-col sm:flex-row gap-2">
                            <a id="corp-apply-display" href="javascript:void(0)" target="_blank" class="flex-1 bg-white px-4 py-3 rounded-lg border border-blue-200 font-medium text-slate-600 truncate shadow-sm hover:text-blue-600 hover:bg-blue-50 transition-colors text-sm">
                                링크 불러오는 중...
                            </a>
                            <button onclick="copyCorpApply()" class="btn-primary px-5 py-3 rounded-lg sm:w-auto w-full whitespace-nowrap text-sm">
                                복사
                            </button>
                        </div>
                    </div>
                    <p id="copyCorpMsg" class="hidden text-sm text-green-600 mt-3 font-bold text-center sm:text-left"><i class="fas fa-check-circle"></i> 링크가 복사되었습니다.</p>
                </div>

                <!-- 관리자 페이지 -->
                <div class="bg-slate-100 p-6 rounded-xl border border-slate-200 mb-8">
                    <label class="block font-bold text-slate-800 mb-4 flex items-center">
                        <i class="fas fa-user-shield mr-2 text-slate-600"></i>관리자 페이지
                    </label>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3">
                        <a href="https://corp.re.kr/member/login/index.php" target="_blank" class="btn-primary px-6 py-3 rounded-lg text-center whitespace-nowrap">
                            <i class="fas fa-sign-in-alt mr-2"></i>로그인
                        </a>
                        <div class="flex-1 bg-white px-4 py-3 rounded-lg border border-slate-300 flex flex-col sm:flex-row gap-2 sm:gap-6">
                            <div class="flex items-center gap-2">
                                <span class="text-sm font-bold text-slate-500">ID</span>
                                <span id="corp-admin-id" class="font-bold text-slate-800">-</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-sm font-bold text-slate-500">PW</span>
                                <span id="corp-admin-pw" class="font-bold text-slate-800">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3 class="font-bold text-slate-700 mb-4 text-lg border-b border-slate-200 pb-2">
                    <i class="fas fa-desktop mr-2"></i>업종별 예시 사이트
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                    <div class="bg-white border-2 border-slate-100 p-5 rounded-xl hover:border-slate-300 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <span class="font-bold text-slate-700 text-lg">제조업</span>
                            <a href="https://www.corp.re.kr/co/testcorp1/" target="_blank" class="text-slate-400 hover:text-blue-600"><i class="fas fa-external-link-alt text-lg"></i></a>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg text-sm text-slate-600">
                            ID: <strong class="text-slate-900 text-base">testcorp1</strong> / PW: <strong class="text-slate-900 text-base">1234</strong>
                        </div>
                    </div>
                    <div class="bg-white border-2 border-slate-100 p-5 rounded-xl hover:border-slate-300 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <span class="font-bold text-slate-700 text-lg">서비스업</span>
                            <a href="https://www.corp.re.kr/co/testcorp2/" target="_blank" class="text-slate-400 hover:text-blue-600"><i class="fas fa-external-link-alt text-lg"></i></a>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg text-sm text-slate-600">
                            ID: <strong class="text-slate-900 text-base">testcorp2</strong> / PW: <strong class="text-slate-900 text-base">1234</strong>
                        </div>
                    </div>
                    <div class="bg-white border-2 border-slate-100 p-5 rounded-xl hover:border-slate-300 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <span class="font-bold text-slate-700 text-lg">기업+연구소 겸용</span>
                            <a href="https://www.corp.re.kr/cn/testcorp/" target="_blank" class="text-slate-400 hover:text-blue-600"><i class="fas fa-external-link-alt text-lg"></i></a>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg text-sm text-slate-600">
                            ID: <strong class="text-slate-900 text-base">testcorp</strong> / PW: <strong class="text-slate-900 text-base">1234</strong>
                        </div>
                    </div>
                    <div class="bg-white border-2 border-slate-100 p-5 rounded-xl hover:border-slate-300 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <span class="font-bold text-slate-700 text-lg">연구소 전용</span>
                            <a href="https://www.corp.re.kr/cn/ptest1/" target="_blank" class="text-slate-400 hover:text-blue-600"><i class="fas fa-external-link-alt text-lg"></i></a>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg text-sm text-slate-600">
                            ID: <strong class="text-slate-900 text-base">ptest1</strong> / PW: <strong class="text-slate-900 text-base">1234</strong>
                        </div>
                    </div>
                </div>

                <div class="mt-6 bg-slate-50 rounded-xl overflow-hidden border border-slate-200">
                    <div class="p-5 flex justify-between items-center cursor-pointer" onclick="toggleAccordion('timestamp-guide')">
                        <span class="font-bold text-lg text-slate-700"><i class="fas fa-stamp mr-2 text-blue-600"></i>시점인증 테스트 가이드</span>
                        <i id="timestamp-guide-icon" class="fas fa-chevron-down text-slate-400 accordion-icon text-xl"></i>
                    </div>
                    <div id="timestamp-guide" class="accordion-content hidden">
                        <div class="p-6 border-t border-slate-200 bg-white">
<div class="text-slate-700 mb-6 font-medium p-4 bg-blue-50 rounded-xl border border-blue-100 text-[13px] sm:text-base leading-relaxed">
    <div class="flex items-start gap-2 mb-3">
        <i class="fas fa-info-circle mt-1 text-blue-600 shrink-0"></i>
        <p>
            <span class="font-bold text-blue-900">연구노트 시점인증 테스트 시:</span><br class="sm:hidden">
            '연구소 전용' 또는 '겸용' 사이트 로그인 후 테스트하세요.
        </p>
    </div>
    <div class="flex items-start gap-2 pt-3 border-t border-blue-200/50">
        <i class="fas fa-info-circle mt-1 text-blue-600 shrink-0"></i>
        <p>
            <span class="font-bold text-blue-900">중요문서 시점인증 테스트 시:</span><br class="sm:hidden">
            '제조업' 또는 '서비스업' 사이트 로그인 후 테스트하세요.
        </p>
    </div>
</div>

                             <ol class="relative border-l-2 border-slate-200 ml-4 space-y-8">                  
<li class="ml-8">
    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">1</span>
    <h4 class="font-bold text-slate-800 text-lg leading-tight">관리자 시점인증 방법 및<br class="sm:hidden"> 연구원 등록 방법</h4>
    
    <div class="mt-3 space-y-4">
        <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
            <p class="text-sm font-black text-blue-700 mb-1">관리자 시점인증 시 :</p>
            <p class="text-slate-600 text-[14px] sm:text-base leading-snug">
                관리자 페이지 → 고객센터 → <br class="sm:hidden">중요문서(시점인증) → [등록]
            </p>
            <p class="text-blue-600 font-bold text-[12px] sm:text-sm mt-1.5 leading-tight">
                ※ 위 페이지에서 ‘등록’ 버튼을 누른 후 <br class="sm:hidden">3번 단계부터 동일하게 진행하세요.
            </p>
        </div>

        <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
            <p class="text-sm font-black text-indigo-700 mb-1">연구원 등록 시 :</p>
            <p class="text-slate-600 text-[14px] sm:text-base leading-snug">
                관리자페이지 → 회원현황 → <br class="sm:hidden">직원관리 → [등록] → ID 생성
            </p>
            <p class="text-red-600 font-bold text-[12px] sm:text-sm mt-1.5">
                ※ 연구원 여부 "연구원" 체크 필수
            </p>
        </div>
    </div>
</li>

                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">2</span>
                                    <h4 class="font-bold text-slate-800 text-lg">연구원 계정 재로그인</h4>
                                    <p class="text-slate-600 mt-1">생성한 ID로 로그인 → 관리자페이지 → 고객센터 → 중요문서(연구노트) → [등록]</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">3</span>
                                    <h4 class="font-bold text-slate-800 text-lg">중요문서/연구노트 첨부 (PDF)</h4>
                                    <p class="text-slate-600 mt-1">PDF 파일 첨부 (변환 시 낮은 버전으로 저장 권장)</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">4</span>
                                    <h4 class="font-bold text-slate-800 text-lg">중요문서/연구노트 개요 입력</h4>
                                    <p class="text-slate-600 mt-1">'내용' 칸에 간단한 개요 입력 (AI 활용 추천)</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">5</span>
                                    <h4 class="font-bold text-slate-800 text-lg">시점인증 파일 다운로드</h4>
                                    <p class="text-slate-600 mt-1">리스트에서 게시물 클릭 → 생성된 인증 파일 다운로드</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">6</span>
                                    <h4 class="font-bold text-slate-800 text-lg">스탬프 확인</h4>
                                    <p class="text-slate-600 mt-1">파일을 열어 시점인증 도장이 찍혔는지 확인</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-white rounded-full -left-4 ring-4 ring-slate-50 border-2 border-slate-300 font-bold text-slate-500">7</span>
                                    <h4 class="font-bold text-slate-800 text-lg">보안 확인 (삭제됨)</h4>
                                    <p class="text-slate-600 mt-1">리스트 재확인 (서버에서 파일이 사라졌는지 확인)</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-green-600 rounded-full -left-4 ring-4 ring-slate-50 border-2 border-white text-white"><i class="fas fa-check"></i></span>
                                    <h4 class="font-bold text-green-700 text-lg">보안 정책 완료</h4>
                                    <p class="text-slate-600 mt-1">본사 서버는 시점인증된 자료 파일을 보관하지 않습니다. (해킹 방지)</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="info-card border-l-teal-600"> <div class="p-6 md:p-8">
                <div class="flex justify-between items-center mb-6 border-b border-slate-200 pb-2">
                     <h2 class="text-xl font-bold text-slate-800">
                        <i class="fas fa-briefcase text-teal-700 mr-2"></i> 컨설턴트 홈페이지
                    </h2>
                </div>

<div class="bg-slate-50 p-5 rounded-xl border border-slate-200 mb-6 flex flex-col sm:flex-row justify-between items-center shadow-sm gap-3">
    <span class="text-slate-700 font-bold text-lg text-center sm:text-left">
        <i class="fas fa-hand-holding-dollar text-teal-600 mr-2"></i>컨설턴트 홈페이지 회원 모집 수수료
    </span>
    <span class="text-teal-600 font-black text-4xl sm:text-2xl">20%</span>
</div>

                <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 mb-5">
                    <label class="block text-sm font-bold text-slate-500 mb-2">홍보용 URL (고객 전달용)</label>
                    <div class="flex flex-col sm:flex-row gap-2">
                         <a id="promoLink" href="https://cn-homepage.netlify.app/" target="_blank" class="flex-1 text-blue-600 font-bold hover:underline truncate bg-white p-3 rounded border border-slate-200 flex items-center">
                            https://cn-homepage.netlify.app/
                         </a>
                        <button onclick="copyPromoURL()" class="bg-white border border-slate-300 text-slate-700 px-4 py-3 rounded font-bold hover:bg-slate-50 transition-colors shadow-sm sm:w-auto w-full">
                            복사
                        </button>
                    </div>
                    <p id="copyPromoMsg" class="hidden text-sm text-green-600 font-bold mt-2"><i class="fas fa-check"></i> 복사되었습니다.</p>
                </div>

                <div class="mb-6">
                     <a href="http://www.consultant.re.kr" target="_blank" class="w-full block text-center bg-white border border-slate-300 text-slate-700 font-bold py-3 rounded-lg hover:bg-slate-50 transition-colors shadow-sm">
                        <i class="fas fa-eye mr-2"></i> 미러 사이트 바로가기
                    </a>
                </div>

                <div>
                    <h3 class="font-bold text-slate-700 mb-2 text-sm"><i class="fas fa-list mr-2"></i> 이용료 구조</h3>
                    <div class="overflow-x-auto border border-slate-200 rounded-xl">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-100 text-slate-700 uppercase">
                                <tr>
                                    <th class="px-4 py-3 font-bold">항목</th>
                                    <th class="px-4 py-3 font-bold">비용/내용</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100 bg-white">
                                <tr>
                                    <td class="px-4 py-3 font-bold text-slate-600">초기 세팅비</td>
                                    <td class="px-4 py-3">100만원 <span class="text-red-500 font-bold">(설명회 현장신청 시 특별할인 진행)</span></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 font-bold text-slate-600">등록비</td>
                                    <td class="px-4 py-3">10만원 (서버등록실비)</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 font-bold text-slate-600">월 이용료</td>
                                    <td class="px-4 py-3">10만원 <span class="text-blue-600 font-bold">(지사 7만원)</span></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 font-bold text-slate-600">웹호스팅비</td>
                                    <td class="px-4 py-3">종량제 과금 (By 이용량)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

<section class="info-card border-l-slate-700"> 
    <div class="p-6 md:p-8">
        <h2 class="text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2 flex items-center">
            <i class="fas fa-hand-holding-dollar text-slate-600 mr-2"></i> 수수료 및 인센티브 정책
        </h2>
        <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
            <div class="flex flex-col sm:flex-row justify-between items-center gap-6">
                <div class="text-center sm:text-left">
                    <span class="block font-bold text-slate-700 text-lg mb-1">이너회원 모집 인센티브</span>
                    <span class="text-sm text-slate-500 leading-relaxed">
                        지사 Code로 연결된 이너서클 회원의<br class="sm:hidden"> ‘기업 홈페이지’ 모집 수수료
                    </span>
                </div>
                <div class="text-center sm:text-right">
                    <span class="text-xs text-slate-500 font-bold block mb-1">모집 수수료</span>
                    <span class="text-blue-700 font-black text-4xl sm:text-2xl">20%</span>
                </div>
            </div>
        </div>
    </div>
</section>

        <section id="remarks-section" class="info-card hidden border-l-gray-400">
            <div class="p-5 bg-slate-100 cursor-pointer flex justify-between items-center" onclick="toggleAccordion('remarks-body')">
                <span class="font-bold text-slate-700"><i class="fas fa-sticky-note mr-2"></i> 비고 (Remarks)</span>
                <i id="remarks-body-icon" class="fas fa-chevron-down accordion-icon text-slate-500"></i>
            </div>
            <div id="remarks-body" class="accordion-content hidden bg-white">
                <div class="p-6">
                    <div id="remarks-content" class="text-slate-700 whitespace-pre-wrap leading-relaxed"></div>
                </div>
            </div>
        </section>
        
        <div class="grid grid-cols-1 gap-4 mb-10">
             <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                 <a href="http://pf.kakao.com/_NcNVG" target="_blank" class="bg-[#FEE500] hover:bg-[#FDD835] text-[#3C1E1E] p-5 rounded-xl flex items-center justify-between shadow-sm transition-transform hover:-translate-y-1">
                    <span class="font-bold text-lg"><i class="fas fa-comment mr-2"></i> 지사 전용 채널</span>
                    <i class="fas fa-chevron-right opacity-50"></i>
                 </a>
                 <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="bg-[#FEE500] hover:bg-[#FDD835] text-[#3C1E1E] p-5 rounded-xl flex items-center justify-between shadow-sm transition-transform hover:-translate-y-1">
                    <span class="font-bold text-lg"><i class="fas fa-comment mr-2"></i> 이너서클 채널</span>
                    <i class="fas fa-chevron-right opacity-50"></i>
                 </a>
             </div>

             <a href="https://pro-content.netlify.app/" target="_blank" class="bg-gradient-to-r from-purple-700 to-indigo-800 hover:from-purple-800 hover:to-indigo-900 text-white p-5 rounded-xl flex items-center justify-between shadow-lg transition-transform hover:-translate-y-1 mt-2">
                <div>
                    <span class="block font-black text-xl"><i class="fas fa-star mr-2 text-yellow-300"></i> 역량강화 Contents</span>
                    <span class="text-sm text-purple-200 mt-1">회원 전용 교육 자료 안내 바로가기</span>
                </div>
                <i class="fas fa-external-link-alt text-2xl opacity-70"></i>
             </a>
        </div>

    </div> 
    
<div id="commission-statement" class="tab-content hidden pb-6 sm:pb-12 animate-fade-in">
      <div id="commission-content">
        <div class="flex items-center gap-3 mb-6 bg-white p-5 rounded-xl shadow-sm border border-slate-200">
          <label for="month-select" class="font-bold text-slate-700 text-lg whitespace-nowrap">조회 월:</label>
          <div class="relative flex-grow">
              <select id="month-select" class="w-full appearance-none bg-slate-50 border border-slate-300 text-slate-800 py-3 px-4 pr-10 rounded-lg focus:outline-none focus:border-slate-800 font-bold text-lg"></select>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-slate-500">
                <i class="fas fa-chevron-down"></i>
              </div>
          </div>
        </div>

        <div id="statement-paper" class="bg-white p-6 sm:p-10 rounded-xl shadow-lg border border-slate-200 print:shadow-none print:border-none">
          </div>
      </div>
      
      <div id="no-commission-data" class="hidden text-center py-24 bg-slate-50 rounded-xl border-2 border-dashed border-slate-300">
        <i class="fas fa-inbox text-5xl text-slate-300 mb-4"></i>
        <h3 class="text-xl font-bold text-slate-500">조회할 수수료 내역이 없습니다.</h3>
      </div>
    </div> 
    
<div class="text-center py-6 mt-6 sm:py-10 sm:mt-12 text-sm text-slate-400 border-t border-slate-200 font-medium">
    제작_(주)한국FP센터 &nbsp;|&nbsp; Copyright © 2025 All Rights Reserved.
</div>

  </div>

<script>
// [로직 완전 유지] 기존 기능 100% 동일

let allCommissions = {};
let currentUser = {};

// 페이지 로드 시 자동 로그인 체크
window.addEventListener('DOMContentLoaded', () => {
  const savedId = localStorage.getItem('savedId');
  const savedPw = localStorage.getItem('savedPw');
  
  if (savedId && savedPw) {
    document.getElementById('username').value = savedId;
    document.getElementById('password').value = savedPw;
    handleLogin(); // 자동 로그인 시도
  }
});

// 로그아웃
function handleLogout() {
  localStorage.removeItem('savedId');
  localStorage.removeItem('savedPw');
  currentUser = {};
  allCommissions = {};
  document.getElementById('main-content').classList.add('hidden');
  document.getElementById('login-container').classList.remove('hidden');
  document.getElementById('username').value = '';
  document.getElementById('password').value = '';
}

// index.html의 handleLogin 함수를 아래와 같이 수정
async function handleLogin() {
  const id = document.getElementById('username').value;
  const pw = document.getElementById('password').value;
  const errorMessage = document.getElementById('error-message');
  const loading = document.getElementById('loading');
  
  if (!id || !pw) {
    errorMessage.innerText = '아이디와 비밀번호를 모두 입력해주세요.';
    return;
  }
  errorMessage.innerText = '';
  loading.classList.remove('hidden');

  // [중요] 여기에 방금 복사한 구글 앱스 스크립트 URL을 넣으세요!
  const GAS_URL = "https://script.google.com/macros/s/AKfycbwGVxmH5x1L57Wo3Lp-4FzVILl38cjb870xRkTo2ex_9OfRyN6ND6FtaBNVUo7E6CccCQ/exec";

  try {
    // 네트리파이 내부 주소(/.netlify/...)가 아니라 구글 주소로 직접 요청을 보냅니다.
    const response = await fetch(GAS_URL, {
      method: 'POST',
      body: JSON.stringify({ id, pw })
    });
    
    const data = await response.json();

    if (data.success) {
      // 로그인 정보 저장
      localStorage.setItem('savedId', id);
      localStorage.setItem('savedPw', pw);
      successLogin(data.user, data.commissions, data.notice);
    } else {
      errorMessage.innerText = data.message;
    }
  } catch (error) {
    errorMessage.innerText = '연결 오류가 발생했습니다.';
    console.error('Login error:', error);
  } finally {
    loading.classList.add('hidden');
  }
}
function successLogin(user, commissions, notice) {
      currentUser = user;
      allCommissions = commissions || {};
      const noticeData = notice;
      
      document.title = `${currentUser.name} 지사장님 페이지`;
      document.getElementById('user-title').innerHTML = `${currentUser.name}`;
      
      if(noticeData) {
          document.getElementById('notice-title').innerText = noticeData.title;
          document.getElementById('notice-content').innerHTML = formatContent(noticeData.content);
      } else {
          document.getElementById('notice-title').innerText = "현재 등록된 공지사항이 없습니다.";
          document.getElementById('notice-content').innerHTML = "새로운 소식이 있으면 이곳에 표시됩니다.";
      }

      // [FP센터 정보]
      document.getElementById('fp-id').innerText = currentUser.fp_id;
      document.getElementById('fp-pw').innerText = currentUser.fp_pw;
      const fpUrlElement = document.getElementById('fp-url');
      const fpFullUrl = `https://kfpcenter.co.kr/?code=${currentUser.fp_id.toUpperCase()}`;
      fpUrlElement.href = fpFullUrl;
      fpUrlElement.innerText = fpFullUrl;
      
      // [기업 링크 - 문의]
const corpInquiryDisplay = document.getElementById('corp-inquiry-display');
if (currentUser.corp_inquiry && currentUser.corp_inquiry.trim() !== '') {
    corpInquiryDisplay.innerText = currentUser.corp_inquiry;
    corpInquiryDisplay.href = currentUser.corp_inquiry;
} else {
    corpInquiryDisplay.innerText = "링크 생성 대기중 (본사 문의)";
    corpInquiryDisplay.href = "javascript:void(0)";
    corpInquiryDisplay.style.cursor = "default";
}

      // [기업 링크 - 제작]
const corpApplyDisplay = document.getElementById('corp-apply-display');
if (currentUser.corp_apply && currentUser.corp_apply.trim() !== '') {
    corpApplyDisplay.innerText = currentUser.corp_apply;
    corpApplyDisplay.href = currentUser.corp_apply;
} else {
    corpApplyDisplay.innerText = "링크 생성 대기중 (본사 문의)";
    corpApplyDisplay.href = "javascript:void(0)";
    corpApplyDisplay.style.cursor = "default";
}

      // [기업 관리자 ID/PW]
document.getElementById('corp-admin-id').innerText = currentUser.corp_admin_id || '-';
document.getElementById('corp-admin-pw').innerText = currentUser.corp_admin_pw || '-';

      // [비고]
      const remarksContent = document.getElementById('remarks-content');
      const remarksSection = document.getElementById('remarks-section');
      if (currentUser.remarks && currentUser.remarks.trim() !== '') {
          remarksContent.innerHTML = formatContent(currentUser.remarks);
          remarksSection.classList.remove('hidden');
      } else {
          remarksSection.classList.add('hidden');
      }

      populateMonthSelector(allCommissions);
      
      // 비밀번호 변경 여부 체크
      if (currentUser.pw_changed !== 'true' && currentUser.pw_changed !== true) {
        // 최초 로그인 - 비밀번호 변경 필요
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('password-change-modal').classList.remove('hidden');
      } else {
        // 비밀번호 변경 완료 - 메인 화면으로
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('main-content').classList.remove('hidden');
        document.getElementById('main-content').classList.add('animate-fade-in');
        showTab('account-info');
      }
}

function copyCorpInquiry() {
    const text = document.getElementById("corp-inquiry-display").innerText;
    if (text.includes("대기중")) return;

    navigator.clipboard.writeText(text).then(() => {
        const msg = document.getElementById("copyCorpMsg");
        msg.classList.remove('hidden');
        setTimeout(() => { msg.classList.add('hidden'); }, 2000);
    });
}

function copyCorpApply() {
    const text = document.getElementById("corp-apply-display").innerText;
    if (text.includes("대기중")) return;

    navigator.clipboard.writeText(text).then(() => {
        const msg = document.getElementById("copyCorpMsg");
        msg.classList.remove('hidden');
        setTimeout(() => { msg.classList.add('hidden'); }, 2000);
    });
}

function copyPromoURL() {
  const link = document.getElementById("promoLink").href;
  navigator.clipboard.writeText(link).then(() => {
    const msg = document.getElementById("copyPromoMsg");
    msg.classList.remove('hidden');
    setTimeout(() => { msg.classList.add('hidden'); }, 1500);
  });
}

// 탭
function showTab(tabId) {
  document.querySelectorAll('.tab-content').forEach(tab => {
      tab.classList.add('hidden');
  });
  document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.classList.remove('active');
  });
  
  document.getElementById(tabId).classList.remove('hidden');
  const btnId = `tab-btn-${tabId.split('-')[0]}`;
  document.getElementById(btnId).classList.add('active');
}

// 아코디언
function toggleAccordion(elementId) {
  const content = document.getElementById(elementId);
  const icon = document.getElementById(elementId + '-icon');
  
  if (content.classList.contains('hidden')) {
    content.classList.remove('hidden');
    requestAnimationFrame(() => {
        content.classList.add('open');
    });
    if(icon) icon.classList.add('rotate-180');
  } else {
    content.classList.remove('open');
    if(icon) icon.classList.remove('rotate-180');
    setTimeout(() => {
        content.classList.add('hidden');
    }, 300); 
  }
}

// 월 선택
// index.html 내의 함수 수정
function populateMonthSelector(commissions) {
  const select = document.getElementById('month-select');
  select.innerHTML = '';
  // 이제 ym은 "2025-09" 같은 문자열입니다.
  const months = Object.keys(commissions).sort().reverse(); 

  if (months.length === 0) {
    document.getElementById('commission-content').classList.add('hidden');
    document.getElementById('no-commission-data').classList.remove('hidden');
    return;
  }
  
  document.getElementById('commission-content').classList.remove('hidden');
  document.getElementById('no-commission-data').classList.add('hidden');

  months.forEach(month => {
    const parts = month.split('-'); // ["2025", "09"]
    const option = document.createElement('option');
    option.value = month;
    option.textContent = `${parts[0]}년 ${parseInt(parts[1], 10)}월`;
    select.appendChild(option);
  });
  
  displayCommissionStatement(months[0]);
  
  select.onchange = (event) => {
    displayCommissionStatement(event.target.value);
  };
}

// 명세서
function displayCommissionStatement(month) {
  const paper = document.getElementById('statement-paper');
  const monthData = allCommissions[month]; 
  
  if (!monthData || !monthData.details || monthData.details.length === 0) {
    paper.innerHTML = '<p class="text-center text-slate-500 py-10">해당 월의 데이터가 없습니다.</p>';
    return;
  }

  const formatNumber = (num) => num ? num.toLocaleString('ko-KR') : '0';
  
  let total = { commission: 0, tax: 0, net: 0 };
  let tableRows = '';

  monthData.details.forEach(item => {
    total.commission += item.commission;
    total.tax += item.tax;
    total.net += item.net;
    tableRows += `
      <tr class="transition-colors">
        <td class="p-3 border border-slate-200 text-center text-sm text-slate-600">${item.date || '-'}</td>
        <td class="p-3 border border-slate-200 text-center text-sm text-slate-800 font-bold">${item.name || '-'}</td>
        <td class="p-3 border border-slate-200 text-center text-sm text-slate-600">${item.product || '-'}</td>
        <td class="p-3 border border-slate-200 text-center text-sm text-slate-600">${item.type || '-'}</td>
        <td class="p-3 border border-slate-200 text-right text-sm text-slate-700">${formatNumber(item.commission)}</td>
        <td class="p-3 border border-slate-200 text-right text-sm text-red-500">${formatNumber(item.tax)}</td>
        <td class="p-3 border border-slate-200 text-right text-sm font-black text-blue-700">${formatNumber(item.net)}</td>
      </tr>
    `;
  });
  
  const [year, m] = month.split('-');
  const paymentDateText = monthData.paymentDate || '별도 공지';

  paper.innerHTML = `
    <div class="flex justify-between items-start border-b-2 border-slate-800 pb-4 mb-6">
      <div class="mt-2">
        <h2 class="text-3xl font-black text-slate-800">수수료 명세서</h2>
        <p class="text-slate-500 mt-1 text-lg font-bold">(${year}년 ${parseInt(m, 10)}월분)</p>
      </div>
      <div class="text-right text-xs text-slate-500 leading-relaxed">
        <strong class="text-slate-800 block text-base mb-1">(주)한국FP센터</strong>
        대표자: 현혜원 <span class="mx-1">|</span> 등록번호: 220-88-43085<br>
        서울시 송파구 위례서로 252 유원플러스B/D 326호
      </div>
    </div>
    
    <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 flex flex-col sm:flex-row justify-between gap-2">
      <p class="text-base"><strong class="text-slate-600 mr-2">수취인:</strong> <span class="text-xl font-black text-slate-900 underline decoration-slate-300 underline-offset-4">${currentUser.name} 귀하</span></p>
      <p class="text-base"><strong class="text-slate-600 mr-2">지급일자:</strong> <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded font-bold">${paymentDateText}</span></p>
    </div>
    
    <div class="overflow-x-auto">
      <table class="w-full border-collapse custom-table min-w-[700px]">
        <thead>
          <tr class="bg-slate-200 text-slate-700">
            <th class="p-4 border border-slate-300">일자</th>
            <th class="p-4 border border-slate-300">성명</th>
            <th class="p-4 border border-slate-300">상품명</th>
            <th class="p-4 border border-slate-300">구분</th>
            <th class="p-4 border border-slate-300">수수료</th>
            <th class="p-4 border border-slate-300">원천징수(3.3%)</th>
            <th class="p-4 border border-slate-300 text-blue-800">실지급액</th>
          </tr>
        </thead>
        <tbody>${tableRows}</tbody>
        <tfoot class="bg-slate-100 font-bold text-slate-800">
          <tr>
            <td colspan="4" class="p-4 border border-slate-300 text-center text-lg">합계</td>
            <td class="p-4 border border-slate-300 text-right">${formatNumber(total.commission)}</td>
            <td class="p-4 border border-slate-300 text-right text-red-600">${formatNumber(total.tax)}</td>
            <td class="p-4 border border-slate-300 text-right text-blue-700 text-lg font-black">${formatNumber(total.net)}</td>
          </tr>
        </tfoot>
      </table>
    </div>
    
    <div class="mt-8 text-right">
      <p class="text-base text-slate-500 mb-1 font-bold">실지급액 합계</p>
      <p class="text-4xl font-black text-blue-700">₩ ${formatNumber(total.net)}</p>
    </div>
  `;
}

// 비밀번호 변경 처리
async function handlePasswordChange() {
  const newPw = document.getElementById('new-password').value;
  const newPwConfirm = document.getElementById('new-password-confirm').value;
  const errorMsg = document.getElementById('pw-change-error');
  const loading = document.getElementById('pw-change-loading');
  
  // 유효성 검사
  if (!newPw || !newPwConfirm) {
    errorMsg.innerText = '새 비밀번호를 입력해주세요.';
    return;
  }
  if (newPw !== newPwConfirm) {
    errorMsg.innerText = '비밀번호가 일치하지 않습니다.';
    return;
  }
  
  errorMsg.innerText = '';
  loading.classList.remove('hidden');
  
  const GAS_URL = "https://script.google.com/macros/s/AKfycbwGVxmH5x1L57Wo3Lp-4FzVILl38cjb870xRkTo2ex_9OfRyN6ND6FtaBNVUo7E6CccCQ/exec";
  const oldPw = localStorage.getItem('savedPw');
  
  try {
    const response = await fetch(GAS_URL, {
      method: 'POST',
      body: JSON.stringify({
        action: 'changePassword',
        id: currentUser.id,
        oldPw: oldPw,
        newPw: newPw
      })
    });
    
    const data = await response.json();
    
    if (data.success) {
      // 새 비밀번호로 localStorage 업데이트
      localStorage.setItem('savedPw', newPw);
      
      // 메인 화면으로 이동
      document.getElementById('password-change-modal').classList.add('hidden');
      document.getElementById('main-content').classList.remove('hidden');
      document.getElementById('main-content').classList.add('animate-fade-in');
      showTab('account-info');
    } else {
      errorMsg.innerText = data.message;
    }
  } catch (error) {
    errorMsg.innerText = '연결 오류가 발생했습니다.';
    console.error('Password change error:', error);
  } finally {
    loading.classList.add('hidden');
  }
}

function formatContent(text) {
    if (!text) return '';
    let safeText = text.replace(/</g, "&lt;").replace(/>/g, "&gt;");
    let textWithBreaks = safeText.replace(/\n/g, '<br>');
    const urlRegex = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])|(\bwww\.[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return textWithBreaks.replace(urlRegex, function(url) {
        const fullUrl = url.startsWith('www.') ? 'http://' + url : url;
        return '<a href="' + fullUrl + '" target="_blank" class="text-blue-600 hover:underline break-all">' + url + '</a>';
    });
}
</script>
</body>
</html>